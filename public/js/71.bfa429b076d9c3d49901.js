(window.webpackJsonp=window.webpackJsonp||[]).push([[71],{1459:function(e,i,t){"use strict";t.r(i);var n=t(0);function a(e,i){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);i&&(n=n.filter((function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable}))),t.push.apply(t,n)}return t}function l(e){for(var i=1;i<arguments.length;i++){var t=null!=arguments[i]?arguments[i]:{};i%2?a(Object(t),!0).forEach((function(i){o(e,i,t[i])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(t,i))}))}return e}function o(e,i,t){return i in e?Object.defineProperty(e,i,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[i]=t,e}var s={name:"list-vehicles",metaInfo:{title:"Lista de vehiculos"},components:{formVehicle:t(99).a},created:function(){var e=this;this.viewPermissions()||this.$router.push({name:"not-found"}),this.getVehicles(this.search).then((function(i){e.totalRows=i}))},data:function(){return{columns:[{label:"Sucursal o convenio",field:"branch_or_agreement"},{label:"Ciudad radicado",field:"settled_city"},{label:"Placa",field:"car_plate"},{label:"Vinculación a la empresa",field:"date_association_company"},{label:"Departamento",field:"department.name"},{label:"Municipio",field:"municipality.name"},{label:"Numero interno",field:"internal_number"},{label:"Fecha matricula",field:"enrollment_date"},{label:"Número chasis",field:"chassis_number"},{label:"Número de motor",field:"engine_number"},{label:"Modelo",field:"model"},{label:"Marca",field:"brand"},{label:"Cilindraje",field:"cylinder"},{label:"Color",field:"color"},{label:"Clase de auto",field:"auto_type"},{label:"Número de puestos",field:"number_seats"},{label:"Vinculación",field:"vinculation"},{label:"Acciones",field:"actions"}],vehicleInEdition:{},totalRows:0,search:{page:1,name:""}}},methods:l(l(l({},Object(n.b)("vehicle",["getVehicles","updateVehicle","deleteVehicle","unlink"])),Object(n.d)(["CHANGE_SUBMIT_STATUS"])),{},{viewPermissions:function(){return this.abilities.includes("*")||this.abilities.includes("vehiculos-listar")},administrationPermissions:function(){return this.abilities.includes("*")||this.abilities.includes("vehiculos-administracion")},showModalEditVehicle:function(e){this.vehicleInEdition=clone(e),this.$refs["modal-edit-vehicle"].show()},showModalDeleteVehicle:function(e){var i=this;this.$bvModal.msgBoxConfirm("una vez ejecutada la acción no podra recuperar la información",{title:"¿Está seguro de eliminar el vehiculo?",size:"sm",buttonSize:"sm",okVariant:"danger",okTitle:"Eliminar",cancelTitle:"NO",footerClass:"p-2",hideHeaderClose:!1,centered:!0}).then((function(t){t&&i.deleteVehicle(e.id).then((function(e){"vehicle successfully removed"==e&&openNotification("Vehiculo eliminado corrrectamente","Se ha eliminado el Vehiculo")}))}))},save:function(e){var i=this;this.updateVehicle(e).then((function(e){openNotification(),i.CHANGE_SUBMIT_STATUS(!0),i.$refs["modal-edit-vehicle"].hide()})).catch((function(e){openNotification("Error","No se pudieron guardar los datos","danger"),i.CHANGE_SUBMIT_STATUS(!1)}))},modalUnlink:function(e){var i=this;this.$bvModal.msgBoxConfirm("Se desvinculara el vehiculo y se generara un reporte",{title:"¿Está seguro de desea desvincular el vehiculo?",size:"sm",buttonSize:"sm",okVariant:"danger",okTitle:"Desvincular",cancelTitle:"NO",footerClass:"p-2",hideHeaderClose:!1,centered:!0}).then((function(t){i.unlink(e.id).then((function(e){"success"==e&&openNotification("Vehiculo desvinculado corrrectamente","Se ha desvinculado el Vehiculo")}))}))},showDetail:function(e){this.$router.push({name:"detalle-vehiculo",params:{id:e}})},onPageChange:function(e){this.search.page=e.currentPage,this.getVehicles(this.search)},onSearch:function(e){this.search.name=e.searchTerm}}),computed:l(l({},Object(n.e)("auth",["abilities"])),Object(n.e)("vehicle",["vehicles"])),watch:{"search.name":function(e){var i=this;this.getVehicles(this.search).then((function(e){i.totalRows=e}))}},filters:{isVinculated:function(e){return e?"Vinculado":"Desvinculado"}}},c=t(2),r=Object(c.a)(s,(function(){var e=this,i=e.$createElement,t=e._self._c||i;return t("div",{staticClass:"main-content"},[t("breadcumb",{attrs:{page:"Lista de vehiculos",folder:"vehiculos"}}),e._v(" "),t("b-card",[t("vue-good-table",{attrs:{rows:e.vehicles,columns:e.columns,"line-numbers":!1,"total-rows":e.totalRows,"search-options":{enabled:!0,trigger:"enter",placeholder:"Digita una placa y presiona enter"},"pagination-options":{enabled:!0,perPage:20,mode:"records",nextLabel:">",prevLabel:"<"},styleClass:"tableOne vgt-table"},on:{"on-page-change":e.onPageChange,"on-search":e.onSearch},scopedSlots:e._u([{key:"table-row",fn:function(i){return["actions"==i.column.field?t("div",[e.administrationPermissions()?[t("a",{staticClass:"clickeable",on:{click:function(t){return e.showModalEditVehicle(i.row)}}},[t("i",{staticClass:"i-Eraser-2 text-25 text-success mr-2"}),e._v("\n              "+e._s(i.row.button)+"\n            ")]),e._v(" "),t("a",{staticClass:"clickeable",on:{click:function(t){return e.showModalDeleteVehicle(i.row)}}},[t("i",{staticClass:"i-Close-Window text-25 text-danger"}),e._v("\n              "+e._s(i.row.button)+"\n            ")])]:e._e(),e._v(" "),t("a",{staticClass:"clickeable",on:{click:function(t){return t.preventDefault(),e.showDetail(i.row.id)}}},[t("i",{staticClass:"i-Eye text-25 text-primary"})])],2):"vinculation"==i.column.field?t("div",[e.abilities.includes("*")||e.abilities.includes("vehiculos-vinculacion")?[i.row.its_linked?t("b-button",{attrs:{variant:"outline-danger",size:"sm"},on:{click:function(t){return e.modalUnlink(i.row)}}},[e._v("Desvincular\n            ")]):t("span",{staticClass:"text-muted text-warning"},[e._v("Desvinculado")])]:t("b-button",[e._v(e._s(e._f("isVinculated")(i.row.its_linked)))])],2):e._e()]}}])},[e.administrationPermissions()?t("div",{staticClass:"mb-3",attrs:{slot:"table-actions"},slot:"table-actions"},[t("router-link",{staticClass:"btn btn-primary btn-rounded d-none d-sm-block",attrs:{tag:"a",to:{name:"nuevo-vehiculo"}}},[t("i",{staticClass:"i-Add-User text-white mr-2"}),e._v("Ingresar vehiculo\n        ")])],1):e._e()])],1),e._v(" "),t("b-modal",{ref:"modal-edit-vehicle",attrs:{centered:"",title:"Actualizar vehículo","hide-footer":""}},[t("form-vehicle",{attrs:{vehicle:e.vehicleInEdition},on:{save:e.save}})],1)],1)}),[],!1,null,"9ce0472c",null);i.default=r.exports}}]);