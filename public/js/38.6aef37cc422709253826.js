(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{1482:function(e,t,r){"use strict";r.r(t);var a=r(1),n=r.n(a),i=(r(5),r(0)),c=r(20),s=r.n(c);function o(e,t,r,a,n,i,c){try{var s=e[i](c),o=s.value}catch(e){return void r(e)}s.done?t(o):Promise.resolve(o).then(a,n)}function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){d(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var b={name:"index",created:function(){var e=this;this.CHANGE_SUBMIT_STATUS(!1),this.getVehicleManteninace(this.search).then((function(t){e.rows=t}))},data:function(){return{search:{page:1,from:"",to:"",car_plate:""},currentPage:1,perPage:20,rows:0,fields:[{key:"car_plate",label:"Vehiculo"},{key:"driver",label:"Conductor"},{key:"type",label:"Tipo de vehÃ­culo"},{key:"date",label:"Fecha de Entrega"},{key:"pase"},{key:"vence"},{key:"categoria"},{key:"observaciones"},{key:"total_gasto"},{key:"actions",label:"Acciones"}],currentVehicle:{car_plate:"",driver:""},itemsVehicle:null,itemsfields:[{key:"km"},{key:"fecha"},{key:"descripcion"},{key:"valor_servicio"}]}},methods:u(u(u({},Object(i.d)(["CHANGE_SUBMIT_STATUS","CLEAR_ERRORS"])),Object(i.b)("vehicleManteinance",["getVehicleManteninace"])),{},{searchVehicles:function(){var e=this;this.getVehicleManteninace(this.search).then((function(t){e.rows=t}))},reset:function(){this.search.from="",this.search.to="",this.search.car_plate="",this.search.page=1},showTable:function(e){this.currentVehicle={car_plate:e.car_plate,driver:e.driver},this.itemsVehicle=e.items,this.$refs["modal-mantenaince-vehicle"].show()},downloadPdf:function(e){var t,r=this;return(t=n.a.mark((function t(){return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r.CHANGE_SUBMIT_STATUS(!0),t.next=3,axios.get("/api/vehicle-maintenances/generate-pdf/".concat(e),{responseType:"blob"}).then((function(t){s()(t.data,e+"-mantenimiento.pdf"),r.CHANGE_SUBMIT_STATUS(!1)}));case 3:case"end":return t.stop()}}),t)})),function(){var e=this,r=arguments;return new Promise((function(a,n){var i=t.apply(e,r);function c(e){o(i,a,n,c,s,"next",e)}function s(e){o(i,a,n,c,s,"throw",e)}c(void 0)}))})()}}),computed:u(u({},Object(i.e)("vehicleManteinance",["maintenances"])),Object(i.e)(["submitStatus"])),watch:{currentPage:function(e){var t=this;this.search.page=e,this.getVehicleManteninace(this.search).then((function(e){t.rows=e}))}}},h=r(2),p=Object(h.a)(b,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"main-content"},[r("breadcumb",{attrs:{page:"Mantenimiento vehiculos",folder:"inventario"}}),e._v(" "),r("b-card",[r("b-row",[r("b-col",{attrs:{md:"4"}},[r("b-form-group",{attrs:{label:"Desde"}},[r("b-form-input",{attrs:{type:"date",placeholder:"Desde"},model:{value:e.search.from,callback:function(t){e.$set(e.search,"from",t)},expression:"search.from"}})],1)],1),e._v(" "),r("b-col",{attrs:{md:"4"}},[r("b-form-group",{attrs:{label:"Hasta"}},[r("b-form-input",{attrs:{type:"date",placeholder:"Hasta"},model:{value:e.search.to,callback:function(t){e.$set(e.search,"to",t)},expression:"search.to"}})],1)],1),e._v(" "),r("b-col",{attrs:{md:"4"}},[r("b-form-group",{attrs:{label:"Placa"}},[r("b-form-input",{attrs:{placeholder:"Placa"},model:{value:e.search.car_plate,callback:function(t){e.$set(e.search,"car_plate",t)},expression:"search.car_plate"}})],1)],1),e._v(" "),r("b-col",{staticClass:"mt-4",attrs:{md:"4"}},[r("b-button",{attrs:{variant:"primary"},on:{click:function(t){return e.searchVehicles()}}},[e._v("Buscar")]),e._v(" "),r("b-button",{attrs:{variant:"outline-danger"},on:{click:function(t){return e.reset()}}},[e._v("Resetear")])],1)],1)],1),e._v(" "),r("div",{staticClass:"text-right mt-2"},[r("router-link",{staticClass:"btn btn-primary",attrs:{to:{name:"registrar-mantenimiento-vehiculos"}}},[e._v("Registrar")])],1),e._v(" "),r("div",{staticClass:"text-right mt-2"},[e.maintenances.length?r("b-card",{staticClass:"mt-4"},[r("b-table",{attrs:{striped:"",hover:"",responsive:"",items:e.maintenances,fields:e.fields},scopedSlots:e._u([{key:"cell(date)",fn:function(t){return[e._v("\n          "+e._s(e._f("formatDate")(t.item.date))+"\n        ")]}},{key:"cell(actions)",fn:function(t){return[r("b-button",{attrs:{size:"sm",variant:"outline-primary"},on:{click:function(r){return e.showTable(t.item)}}},[e._v("Ver tabla")]),e._v(" "),r("b-button",{attrs:{disabled:e.submitStatus,size:"sm",variant:"outline-danger"},on:{click:function(r){return e.downloadPdf(t.item.id)}}},[e._v("\n            Descargar pdf\n          ")])]}}],null,!1,2382514516)}),e._v(" "),r("b-pagination",{attrs:{"total-rows":e.rows,"per-page":e.perPage,"aria-controls":"my-table"},model:{value:e.currentPage,callback:function(t){e.currentPage=t},expression:"currentPage"}})],1):e._e()],1),e._v(" "),r("b-modal",{ref:"modal-mantenaince-vehicle",attrs:{size:"lg","hide-footer":"",title:"Vehiculo "+e.currentVehicle.car_plate+" - Conductor "+e.currentVehicle.driver}},[r("b-table",{attrs:{fields:e.itemsfields,items:e.itemsVehicle,striped:"",hover:"",responsive:"",bordered:""}})],1),e._v(" "),r("b-col",{staticClass:"d-flex justify-content-center",class:{"m-28":!e.submitStatus},attrs:{md:"12"}},[e.submitStatus?r("div",{staticClass:"spinner sm spinner-primary mt-3"}):e._e()])],1)}),[],!1,null,"128f90ce",null);t.default=p.exports},20:function(e,t){e.exports=function(e,t,r,a){var n=new Blob(void 0!==a?[a,e]:[e],{type:r||"application/octet-stream"});if(void 0!==window.navigator.msSaveBlob)window.navigator.msSaveBlob(n,t);else{var i=window.URL&&window.URL.createObjectURL?window.URL.createObjectURL(n):window.webkitURL.createObjectURL(n),c=document.createElement("a");c.style.display="none",c.href=i,c.setAttribute("download",t),void 0===c.download&&c.setAttribute("target","_blank"),document.body.appendChild(c),c.click(),setTimeout((function(){document.body.removeChild(c),window.URL.revokeObjectURL(i)}),200)}}}}]);