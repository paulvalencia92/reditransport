(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{1455:function(t,e,a){"use strict";a.r(e);var n=a(1),r=a.n(n),s=a(0);function o(t,e,a,n,r,s,o){try{var c=t[s](o),i=c.value}catch(t){return void a(t)}c.done?e(i):Promise.resolve(i).then(n,r)}function c(t){return function(){var e=this,a=arguments;return new Promise((function(n,r){var s=t.apply(e,a);function c(t){o(s,n,r,c,i,"next",t)}function i(t){o(s,n,r,c,i,"throw",t)}c(void 0)}))}}function i(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function l(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?i(Object(a),!0).forEach((function(e){d(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function d(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var u=a(20),v={metaInfo:{title:"Dashboard"},data:function(){return{loading:!1,data:null,columns:[{label:"Objeto",field:"object"},{label:"Número",field:"number"},{label:"Departamento",field:"department.name"},{label:"Municipio",field:"municipality.name"},{label:"Vehículo",field:"vehicle.car_plate"},{label:"Fecha inicio",field:"start_date"},{label:"Fecha fin",field:"end_date"},{label:"Contratante",field:"contractor.contractor"},{label:"Ingresos",field:"incomes"},{label:"Detalles",field:"details"},{label:"Adicional",field:"aditional"}]}},created:function(){this.getData(),"ADMIN"==this.role?this.getContracts():this.getContractsByUser(this.user.id)},methods:l(l({},Object(s.b)("contracts",["getContractsByUser","getContracts","checkDocuments"])),{},{getData:function(){var t=this;return c(r.a.mark((function e(){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.loading=!0,e.next=4,axios.get("/api/getDashboard").then((function(e){t.data=e.data,t.loading=!1}));case 4:e.next=11;break;case 6:e.prev=6,e.t0=e.catch(0),a=Object.values(e.t0.response.data.errors),context.rootState.errorMessages=a,openNotification("Error","No se pudo obtener información","danger");case 11:return e.prev=11,t.loading=!1,e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[0,6,11,14]])})))()},exportData:function(t){var e=this;return c(r.a.mark((function a(){var n;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,e.loading=!0,a.next=4,axios.get("/api/generate/document/fuec/".concat(t),{responseType:"blob"}).then((function(e){u(e.data,t+"-FUEC.pdf")}));case 4:a.next=11;break;case 6:a.prev=6,a.t0=a.catch(0),n=Object.values(a.t0.response.data.errors),context.rootState.errorMessages=n,openNotification("Error","No se pudo generar el Fuec, consulta un administrador","danger");case 11:return a.prev=11,e.loading=!1,a.finish(11);case 14:case"end":return a.stop()}}),a,null,[[0,6,11,14]])})))()}}),computed:l(l({},Object(s.e)("contracts",["contracts"])),Object(s.e)("auth",["role","user"]))},b=a(2),m=Object(b.a)(v,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"main-content"},[a("breadcumb",{attrs:{page:"Tablero",folder:"Dashboard"}}),t._v(" "),a("b-row",["ADMIN"==t.role?a("b-col",{attrs:{md:"6",sm:"6",lg:"6",xl:"3",mt:"3"}},[a("b-card",{staticClass:" mb-30"},[a("div",{staticClass:"ul-widget__row-v2"},[a("div",{staticClass:"ul-widget__content-v2"},[a("h4",{staticClass:"heading mt-1"},[t._v(t._s(t.data.users?t.data.users:"0"))]),t._v(" "),a("small",{staticClass:" text-muted m-0"},[t._v("\n              Usuarios\n            ")])])])])],1):t._e(),t._v(" "),"ADMIN"==t.role?a("b-col",{attrs:{md:"6",sm:"6",lg:"6",xl:"3",mt:"3"}},[a("b-card",{staticClass:" mb-30"},[a("div",{staticClass:"ul-widget__row-v2"},[a("div",{staticClass:"ul-widget__content-v2"},[a("h4",{staticClass:"heading mt-1"},[t._v(t._s(t.data.vehicles?t.data.vehicles:"0"))]),t._v(" "),a("small",{staticClass:" text-muted m-0"},[t._v("\n              Vehículos\n            ")])])])])],1):t._e(),t._v(" "),"ADMIN"==t.role?a("b-col",{attrs:{md:"6",sm:"6",lg:"6",xl:"3",mt:"3"}},[a("b-card",{staticClass:" mb-30"},[a("div",{staticClass:"ul-widget__row-v2"},[a("div",{staticClass:"ul-widget__content-v2"},[a("h4",{staticClass:"heading mt-1"},[t._v(t._s(t.data.contracts?t.data.contracts:"0"))]),t._v(" "),a("small",{staticClass:" text-muted m-0"},[t._v("\n              Contratos actuales\n            ")])])])])],1):t._e(),t._v(" "),"ADMIN"==t.role?a("b-col",{attrs:{md:"6",sm:"6",lg:"6",xl:"3",mt:"3"}},[a("b-card",{staticClass:" mb-30"},[a("div",{staticClass:"ul-widget__row-v2"},[a("div",{staticClass:"ul-widget__content-v2"},[a("h4",{staticClass:"heading mt-1"},[t._v(t._s(t.data.accounts?t.data.accounts:"0"))]),t._v(" "),a("small",{staticClass:" text-muted m-0"},[t._v("\n              Cuentas pendientes\n            ")])])])])],1):t._e(),t._v(" "),a("b-col",{attrs:{md:"12",sm:"12",lg:"12",xl:"12",mt:"12"}},[a("b-card",{staticClass:" mb-30"},[a("vue-good-table",{attrs:{columns:t.columns,"line-numbers":!1,styleClass:"tableOne vgt-table",rows:t.contracts},scopedSlots:t._u([{key:"table-row",fn:function(e){return["aditional"==e.column.field?a("span",[1==e.row.blocked_license?a("div",{staticClass:"text-danger"},[t._v("\n              El conductor no tiene licencia valida\n            ")]):t._e(),t._v(" "),1==e.row.blocked_documents?a("div",{staticClass:"text-danger"},[t._v("\n              El vehículo no tiene documentos al día\n            ")]):t._e(),t._v(" "),1==e.row.blocked_payment?a("div",{staticClass:"text-danger"},[t._v("\n              Tienes cuentas por pagar\n            ")]):t._e(),t._v(" "),0==e.row.blocked_license&&0==e.row.blocked_documents&&0==e.row.blocked_payment?a("div",[1!=t.loading?a("b-button",{attrs:{disabled:e.row.routes.length<1,variant:"secondary",size:"sm"},on:{click:function(a){return t.exportData(e.row.id)}}},[t._v("\n                  Descargar Fuec\n              ")]):a("div",{staticClass:"spinner sm spinner-primary"}),t._v(" "),e.row.routes.length<1?a("div",{staticClass:"text-danger"},[t._v("\n                  Debes agregar al menos una ruta\n                ")]):t._e()],1):t._e()]):t._e()]}}])})],1)],1)],1)],1)}),[],!1,null,null,null);e.default=m.exports},20:function(t,e){t.exports=function(t,e,a,n){var r=new Blob(void 0!==n?[n,t]:[t],{type:a||"application/octet-stream"});if(void 0!==window.navigator.msSaveBlob)window.navigator.msSaveBlob(r,e);else{var s=window.URL&&window.URL.createObjectURL?window.URL.createObjectURL(r):window.webkitURL.createObjectURL(r),o=document.createElement("a");o.style.display="none",o.href=s,o.setAttribute("download",e),void 0===o.download&&o.setAttribute("target","_blank"),document.body.appendChild(o),o.click(),setTimeout((function(){document.body.removeChild(o),window.URL.revokeObjectURL(s)}),200)}}}}]);